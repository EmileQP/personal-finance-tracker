{% extends "layout.html" %}

{% block title %}
    Messages
{% endblock %}

{% block main %}
<div class="messages-header">
<a href="/contacts"><img class="backwards-arrow"src="http://127.0.0.1:5000/static/images/arrow-ios-back.svg" alt="Back to main"></a>
<h1>Messages with {{ contact2 }}</h1>
</div>
    <div class="messages-container">
        <div class="messages">
            {% for message in messages %}
                <div class="{{ 'message-sent' if message.sender_id == session['user_id'] else 'message-received' }}">
                    <p>{{ message.message }}</p>
                    
                </div>
                <span class="{{ 'message-sent1' if message.sender_id == session['user_id'] else 'message-received1' }}"> {{ message.timestamp }}</span>
            {% endfor %}
        </div>
        <form action="/messages/{{ contact_me }}" method="post">
            <textarea name="message" placeholder="Type your message here..."></textarea>
            <button type="submit" class="button">Send</button>
        </form>
    </div>
    <script>
        function scrollToBottom() {
        const messagesContainer = document.querySelector('.messages');
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    // Scroll to the bottom when the page loads
    window.onload = scrollToBottom;

    // Handle the form submission
    const messageForm = document.getElementById('message-form');
    messageForm.addEventListener('submit', function(e) {
        // Prevent default form submission
        e.preventDefault();

        // You would normally send the message via AJAX here
        // For now, we'll just scroll to the bottom
        scrollToBottom();

        // After submitting the form, you might want to reload the page or
        // update the messages list via AJAX, depending on your setup.
        // For example, you could use fetch() to send the message and then reload the messages.
    });
    </script>

{% endblock %}

<!--
Messages data insert template:
messages = [
    {"sender": "user1", "text": "Hello!", "timestamp": "10:00 AM"},
    {"sender": "user2", "text": "Hi there!", "timestamp": "10:01 AM"},
    {"sender": "user1", "text": "How are you?", "timestamp": "10:02 AM"},
    {"sender": "user2", "text": "I'm good, thanks!", "timestamp": "10:03 AM"}
]
-->